<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ListenMachine</title>
<style>
  body{margin:0;font-family:system-ui,Arial,sans-serif;background:#f7f7f7;color:#111}
  .wrap{min-height:100vh;display:grid;place-items:center;padding:24px}
  .card{max-width:740px;width:100%;background:#fff;border-radius:16px;box-shadow:0 20px 50px rgba(0,0,0,.08);padding:24px}
  h1{margin:0 0 8px}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  button{border:0;padding:12px 16px;border-radius:12px;background:#111;color:#fff;font-weight:600;cursor:pointer}
  .pill{background:#f0f0f0;border-radius:999px;padding:6px 10px;font-size:13px}
  .grid{display:grid;gap:10px;grid-template-columns:1fr 1fr;margin-top:10px}
  label{font-size:12px;color:#444;margin-bottom:4px;display:block}
  input[type="range"]{width:100%}
  #status{font-size:12px;color:#666;margin-top:8px}
  audio{display:none} /* keep players in DOM but hidden */
</style>
</head>
<body>
<div class="wrap">
  <main class="card">
    <h1>ListenMachine</h1>
    <p>Press <b>Play</b> once. The ambient track plays straight through once; messages start/stop over it (no fades).</p>

    <div class="row"><button id="start">Play</button><span id="status"></span></div>

    <div class="row" style="margin-top:10px;gap:8px">
      <span class="pill">Ambient: <span id="ambName">—</span></span>
      <span class="pill">Message: <span id="msgName">—</span></span>
    </div>

    <div class="grid">
      <div><label for="msgVol">Message volume</label><input id="msgVol" type="range" min="0" max="1" step="0.01" value="0.9"></div>
      <div><label for="ambVol">Ambient volume</label><input id="ambVol" type="range" min="0" max="1" step="0.01" value="0.35"></div>
    </div>

    <!-- Keep elements in the DOM to appease iOS autoplay quirks -->
    <audio id="amb" preload="auto"></audio>
    <audio id="msg" preload="auto"></audio>
  </main>
</div>

<script>
/* ---- Your files ---- */
const FILES = {
  messages: [
    "audio/messages/1.mp3","audio/messages/2.mp3","audio/messages/3.mp3","audio/messages/4.mp3",
    "audio/messages/5.mp3","audio/messages/6.mp3","audio/messages/7.mp3","audio/messages/8.mp3",
    "audio/messages/9.mp3","audio/messages/10.mp3","audio/messages/11.mp3","audio/messages/12.mp3",
    "audio/messages/13.mp3","audio/messages/14.mp3","audio/messages/15.mp3","audio/messages/16.mp3",
    "audio/messages/17.mp3","audio/messages/18.mp3","audio/messages/19.mp3","audio/messages/20.mp3",
    "audio/messages/21.mp3","audio/messages/22.mp3","audio/messages/23.mp3","audio/messages/24.mp3",
    "audio/messages/25.mp3","audio/messages/26.mp3","audio/messages/27.mp3",
